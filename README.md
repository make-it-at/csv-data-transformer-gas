# CSVインポート・エクスポートツール

Google Apps Script (GAS) を使用したシンプルなCSV処理ツールです。

## 概要

スプレッドシート上で動作するCSVファイルの：
- **インポート**: CSVファイルをスプレッドシートに読み込み
- **エクスポート**: スプレッドシートデータをCSVファイルとしてダウンロード

## 主な機能

### 🔄 CSVインポート
- ファイル選択ダイアログからCSVファイルを選択
- UTF-8、Shift_JIS文字コードに対応
- 最大10MB、10,000行まで対応
- 自動でスプレッドシートに展開

### 📥 CSVエクスポート  
- ワンクリックでCSVファイル生成
- UTF-8 (BOM付き) で出力
- タイムスタンプ付きファイル名で自動保存

### 🎯 シンプルUI
- 直感的な操作（1-2クリック）
- リアルタイム進捗表示
- 日本語エラーメッセージ

## 技術仕様

- **プラットフォーム**: Google Apps Script
- **対応ブラウザ**: Chrome, Firefox, Safari, Edge
- **必要権限**: Google スプレッドシート編集権限
- **制限事項**: 
  - 最大ファイルサイズ: 10MB
  - 最大行数: 10,000行
  - 実行時間制限: 6分

## プロジェクト構造

```
├── src/
│   ├── main.gs           # メイン処理・エントリーポイント
│   ├── csvImporter.gs    # CSVインポート機能
│   ├── csvExporter.gs    # CSVエクスポート機能
│   └── utilities.gs      # 共通ユーティリティ
├── html/
│   ├── sidebar.html      # メインUI
│   └── styles.css        # スタイルシート
├── tests/
│   └── test.gs           # テスト関数
├── requirements.md       # 要件定義書
├── README.md            # このファイル
└── .claspignore         # clasp除外設定
```

## セットアップ

### 1. Google Apps Script プロジェクト作成

1. [Google Apps Script](https://script.google.com/) にアクセス
2. 「新しいプロジェクト」をクリック
3. プロジェクト名を「CSVインポート・エクスポートツール」に変更

### 2. ローカル開発環境セットアップ

```bash
# プロジェクトディレクトリに移動
cd your-project-directory

# clasp でログイン（初回のみ）
clasp login

# 新しいGASプロジェクトを作成
clasp create --type standalone --title "CSVインポート・エクスポートツール"

# または既存プロジェクトをクローン
clasp clone [SCRIPT_ID]
```

### 3. ファイルのアップロード

```bash
# ローカルファイルをGASにアップロード
clasp push

# GASエディタを開く
clasp open
```

## 使用方法

### 1. スプレッドシートでの準備

1. Google スプレッドシートを新規作成
2. 「拡張機能」→「Apps Script」を選択
3. 作成したGASプロジェクトのコードを貼り付け

### 2. ツールの起動

1. GASエディタで `showSidebar()` 関数を実行
2. スプレッドシート上にサイドバーが表示される

### 3. CSVインポート

1. サイドバーの「CSVインポート」ボタンをクリック
2. ファイル選択ダイアログでCSVファイルを選択
3. データが自動でスプレッドシートに読み込まれる

### 4. CSVエクスポート

1. エクスポートしたいデータがあるシートを選択
2. サイドバーの「CSVエクスポート」ボタンをクリック
3. CSVファイルが自動でダウンロードされる

## 開発

### 開発フロー

1. ローカルでコード編集
2. `clasp push` でGASにアップロード
3. GASエディタまたはスプレッドシートでテスト
4. 動作確認後、Gitでバージョン管理

### テスト

```bash
# GASエディタでテスト関数を実行
# または clasp run コマンドを使用
clasp run testCSVImport
clasp run testCSVExport
```

### デバッグ

- GASエディタの実行ログを確認
- `console.log()` または `Logger.log()` でログ出力
- スプレッドシートのデータを直接確認

## トラブルシューティング

### よくある問題

**Q: ファイルアップロードができない**
- A: ブラウザがファイルアクセスを許可しているか確認
- A: ファイルサイズが10MB以下か確認

**Q: エクスポートしたCSVが文字化けする**
- A: Excel等で開く際は「UTF-8」を指定して開く
- A: メモ帳等のテキストエディタで確認

**Q: 処理が途中で止まる**
- A: データ量が制限を超えていないか確認
- A: インターネット接続を確認

**Q: 権限エラーが発生する**
- A: スプレッドシートの編集権限があるか確認
- A: GASの実行権限を再度許可

## ライセンス

MIT License

## 貢献

バグ報告や機能改善の提案は Issue でお知らせください。

## 更新履歴

- v1.0.0 (予定): 初期リリース
  - CSVインポート機能
  - CSVエクスポート機能
  - 基本UI実装